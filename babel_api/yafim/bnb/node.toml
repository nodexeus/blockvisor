# HARDWARE SPECS
# VPS running recent versions of Mac OS X, Linux, or Windows.
# IMPORTANT 2 TB of free disk space, solid-state drive(SSD), gp3, 8k IOPS, 250 MB/S throughput, read latency <1ms. (if node is started with snap sync, it will need NVMe SSD)
# 16 cores of CPU and 64 GB of memory (RAM)
# A broadband Internet connection with upload/download speeds of 5 MB/S

# Install Manual https://docs.bnbchain.org/docs/validator/fullnode/

application_name = "bnb"
node_type = "node"
version = "1.1.19-build.1"

[image]
debian_version = "focal"
rootfs_size = "10G"
fs_type = "ext4"
apt_image = []
apt_source = ["universe", "multiverse"]
cmds = [
  "ln -s /etc/systemd/system/babelsup.service /etc/systemd/system/multi-user.target.wants/babelsup.service",
  "systemctl disable systemd-resolved.service",
  "rm /etc/dhcp/dhclient-enter-hooks.d/resolved",
  "rm /etc/resolv.conf",
  "echo 'nameserver 8.8.8.8' > /etc/resolv.conf",
  "echo 'nameserver 1.1.1.1' >> /etc/resolv.conf",
  "apt install unzip -y",
  "bash -c \"wget $(curl -s https://api.github.com/repos/bnb-chain/bsc/releases/latest |grep browser_ |grep geth_linux |cut -d: -f2-3)\"",
  "mv geth_linux /usr/bin/geth && chmod -v u+x /usr/bin/geth",
  "bash -c \"wget $(curl -s https://api.github.com/repos/bnb-chain/bsc/releases/latest |grep browser_ |grep mainnet |cut -d: -f2-3)\"",
  "unzip mainnet.zip",
  #"./geth --config ./config.toml --datadir ./node  --cache 8000 --rpc.allow-unprotected-txs --txlookuplimit 0",
] 

[build_machine]
apt_build_machine = []
git_repo = ""
git_tag = ""
build_cmds =  [
	        "cp {{.YafimHome}}/babelsup/usr/bin/babelsup {{.YafimHome}}/target/bnb/node/mnt/usr/bin/",
		"cp {{.YafimHome}}/babelsup/etc/systemd/system/multi-user.target.wants/babelsup.service {{.YafimHome}}/target/bnb/node/mnt/etc/systemd/system/",
		"cp {{.YafimHome}}/blockvisor/babel_api/protocols/bnb/node.toml {{.YafimHome}}/target/bnb/node/mnt/etc/babel.conf",
		"echo 'root:f&IS_rwh' | chpasswd -R {{.YafimHome}}/target/bnb/node/mnt",
		"echo bnb-node > {{.YafimHome}}/target/bnb/node/mnt/etc/hostname"
]
